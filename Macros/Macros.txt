#Persistent               ; keep script running
SetBatchLines, -1        ; no sleep between lines

; ---- CONFIGURATION ----
Interval := 5000         ; repeat every 5000 ms (5 seconds). Adjust as needed.

; ---- STATE ----
running := false
execCount := 0           ; counts how many times DoMacro() has run

; ---- TOGGLE WITH F9 ----
F9::
    running := !running
    if (running) {
        execCount := 0                      ; reset counter when starting
        SetTimer, DoMacro, %Interval%
        TrayTip,, Macro ON (every %Interval% ms), 1
    } else {
        SetTimer, DoMacro, Off
        TrayTip,, Macro OFF, 1
    }
return

; ---- YOUR MACRO SEQUENCE ----
DoMacro:
    ; 1) Ctrl+Del
    Send, ^{Del}
    Sleep, 50

    ; 2) Shift+F10
    Send, +{F10}
    Sleep, 100

    ; 3) Upâ€arrow
    Send, {Up}
    Sleep, 50

    ; 4) Enter
    Send, {Enter}
    Sleep, 100

    ; 5) Ctrl+V
    Send, ^v
    Sleep, 50

    ; 6) Tab
    Send, {Tab}
    Sleep, 50

    ; increment and check counter
    execCount += 1
    if (execCount >= 10) {
        ; 7) Ctrl+S on every 10th run
        Send, ^s
        execCount := 0
    }
return
